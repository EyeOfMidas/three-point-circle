<html>
<style type="text/css">
	html,
	body {
		margin: 0;
		padding: 0;
	}

	canvas {
		width: 100%;
		height: 100%;
	}
</style>

<body>
	<canvas></canvas>
	<script>
		var canvas, context;
		var mouse = { x: 0, y: 0, button: null };
		document.addEventListener("DOMContentLoaded", () => {
			canvas = document.getElementsByTagName("canvas")[0];
			canvas.width = canvas.clientWidth;
			canvas.height = canvas.clientHeight;
			context = canvas.getContext("2d");
			animate();
		});

		let curvePoints = [];

		function placePoint(point) {
			curvePoints.push({ x: point.x, y: point.y });
			if (curvePoints.length > 3) {
				curvePoints = [];
			}
		}

		function computeCircleFromPoints(p0, p1, p2) {
			let midpointOfPQ = { x: (p0.x + p1.x) / 2, y: (p0.y + p1.y) / 2 };
			let midpointOfQR = { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
			let slopeofPQ = (p1.y - p0.y) / (p1.x - p0.x);
			let slopeofQR = (p2.y - p1.y) / (p2.x - p1.x);

			let PQ = -1 / slopeofPQ;
			let QR = -1 / slopeofQR;

			let centerPoint = {
				x: (- (QR * midpointOfQR.x) + midpointOfQR.y - midpointOfPQ.y + (PQ * midpointOfPQ.x)) / (PQ - QR),
				y: PQ * ((- (QR * midpointOfQR.x) + midpointOfQR.y - midpointOfPQ.y + (PQ * midpointOfPQ.x)) / (PQ - QR) - midpointOfPQ.x) + midpointOfPQ.y
			};

			let radius = Math.abs(Math.hypot(centerPoint.x - p0.x, centerPoint.y - p0.y));

			return { x: centerPoint.x, y: centerPoint.y, radius: radius };
		}

		function update() {
			context.clearRect(0, 0, canvas.width, canvas.height);

			context.fillStyle = "cornflowerblue";
			for (let i = 0; i < curvePoints.length; i++) {
				context.beginPath();
				context.arc(curvePoints[i].x, curvePoints[i].y, 5, 0, 2 * Math.PI);
				context.fill();
			}

			if (curvePoints.length == 3) {
				drawCircle(context, curvePoints[0], curvePoints[1], curvePoints[2]);
			} else if (curvePoints.length == 2) {
				drawCircle(context, curvePoints[0], mouse, curvePoints[1]);
			}

			context.fillStyle = "crimson";
			if (mouse.button == 0) {
				context.fillStyle = "lime";
				mouse.button = null;
				placePoint(mouse);
			}
			context.beginPath();
			context.arc(mouse.x - 2.5, mouse.y - 2.5, 5, 0, 2 * Math.PI);
			context.fill();
		}

		function drawCircle(context, p0, p1, p2) {
			let circleData = computeCircleFromPoints(p0, p1, p2);

			let startAngle = 0;
			let totalAngle = 2 * Math.PI;

			context.strokeStyle = "orange";
			context.lineWidth = 4;
			context.beginPath();
			context.arc(circleData.x, circleData.y, circleData.radius, startAngle, totalAngle);
			context.stroke();
		}

		function animate() {
			update();
			requestAnimationFrame(animate);
		}

		requestAnimationFrame(animate);

		document.addEventListener("mousemove", (event) => {
			mouse.x = event.clientX;
			mouse.y = event.clientY;
		});

		document.addEventListener("mousedown", (event) => {
			mouse.button = event.button;
		});

		document.addEventListener("mouseup", (event) => {
			mouse.button = null;
		});
	</script>
</body>

</html>
